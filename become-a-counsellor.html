<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Become a Counsellor ‚Ä¢ MindCheck</title>
  <meta name="description" content="Become a verified MindCheck counsellor. Take a free certified course, pass the exam, download your certificate, and upload for verification." />

  <!-- Shared theme -->
  <link rel="stylesheet" href="mc-theme.css">

  <style>
    :root{
      --green:#22c55e; --greenDark:#16a34a; --ink:#062436;
      --bg:#f5fdf8; --card:#ffffff; --muted:#52606d;
      --border:#eef2f7; --danger:#ef4444; --warn:#f59e0b;
    }

    /* Calm animated background (CSS-only) */
    body{
      margin:0;
      font-family: "Inter",system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
      color:var(--ink);
      background: radial-gradient(1200px 600px at 10% 10%, rgba(34,197,94,.10), transparent 60%),
                  radial-gradient(900px 500px at 90% 20%, rgba(34,197,94,.08), transparent 55%),
                  var(--bg);
      overflow-x:hidden;
    }
    body::before{
      content:"";
      position:fixed; inset:-40vh -40vw;
      background:
        radial-gradient(circle at 20% 30%, rgba(34,197,94,.10), transparent 35%),
        radial-gradient(circle at 70% 40%, rgba(34,197,94,.08), transparent 38%),
        radial-gradient(circle at 45% 70%, rgba(34,197,94,.06), transparent 40%);
      filter: blur(10px);
      animation: floaty 18s ease-in-out infinite;
      pointer-events:none;
      z-index:-1;
    }
    @keyframes floaty{
      0%,100%{ transform: translate3d(0,0,0) scale(1); }
      50%{ transform: translate3d(2vw, -2vh, 0) scale(1.02); }
    }

    header{
      background:var(--green);
      color:#fff;
      padding:1.1rem 1rem;
      font-size:1.35rem;
      font-weight:900;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    header .left{display:flex;align-items:center;gap:10px;}
    header a{color:#fff;text-decoration:none;font-weight:800;}
    .wrap{max-width:980px;margin:18px auto 40px;padding:0 14px;}

    .topbar{
      display:flex;gap:10px;flex-wrap:wrap;justify-content:space-between;align-items:center;
      margin:14px 0 10px;
    }
    .pill{
      background:#fff;
      border:1px solid #e5e7eb;
      border-radius:999px;
      padding:8px 12px;
      font-weight:800;
      font-size:.95rem;
      display:flex; align-items:center; gap:8px;
    }
    .pill b{font-weight:900}
    .xpbar{
      width:160px; height:10px; border-radius:999px; overflow:hidden;
      background: rgba(2,23,34,.08);
    }
    .xpbar > span{
      display:block; height:100%; width:0%;
      background: linear-gradient(90deg, #22c55e, #16a34a);
      transition: width .25s ease;
    }

    .btn{
      border:none;
      padding:12px 16px;
      border-radius:14px;
      font-size:1rem;
      cursor:pointer;
      transition:.15s;
      font-weight:900;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      text-decoration:none;
      user-select:none;
    }
    .btn-primary{background:var(--green);color:#fff;box-shadow:0 8px 20px rgba(34,197,94,.25);}
    .btn-primary:hover{background:var(--greenDark);transform:translateY(-1px);}
    .btn-ghost{background:#fff;border:1px solid #e5e7eb;color:var(--ink);}
    .btn-ghost:hover{transform:translateY(-1px);}
    .btn-warn{background:rgba(245,158,11,.15);border:1px solid rgba(245,158,11,.35);color:#7c4a00;}
    .btn-warn:hover{transform:translateY(-1px);}
    .btn-danger{background:rgba(239,68,68,.12);border:1px solid rgba(239,68,68,.25);color:#7f1d1d;}

    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
      gap:14px;
      margin-top:12px;
    }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:16px;
      padding:16px;
      box-shadow:0 10px 25px rgba(2,23,34,.06);
      position:relative;
      overflow:hidden;
    }
    .card::after{
      content:"";
      position:absolute; inset:auto -80px -80px auto;
      width:180px; height:180px;
      background: radial-gradient(circle at 30% 30%, rgba(34,197,94,.18), transparent 60%);
      transform: rotate(15deg);
      pointer-events:none;
    }
    .card h2,.card h3{margin:.15rem 0 .35rem;}
    .muted{color:var(--muted);}

    .steps{margin:0;padding-left:18px;line-height:1.6;color:var(--muted);font-weight:600}
    .callout{
      background:#fff;
      border:1px solid #d1fae5;
      border-radius:14px;
      padding:12px;
      color:#065f46;
      font-weight:900;
    }
    .badges{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .badge{
      border-radius:999px;
      padding:8px 10px;
      background:rgba(34,197,94,.12);
      border:1px solid rgba(34,197,94,.22);
      font-weight:900;
      display:inline-flex;align-items:center;gap:8px;
    }
    .badge.lock{background:rgba(2,23,34,.06);border-color:rgba(2,23,34,.10);font-weight:900}
    .badge.done{background:rgba(34,197,94,.14);border-color:rgba(34,197,94,.28)}
    .badge.warn{background:rgba(245,158,11,.15);border-color:rgba(245,158,11,.35)}

    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;}
    input[type="file"]{
      width:100%;
      padding:12px;
      border:1px dashed #cbd5e1;
      border-radius:14px;
      background:#fff;
      font-weight:700;
    }
    small{color:#64748b; font-weight:600;}

    /* Mini toast */
    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform:translateX(-50%);
      background:rgba(2,23,34,.92);
      color:#fff;
      padding:10px 12px;
      border-radius:999px;
      font-weight:900;
      font-size:.95rem;
      display:none;
      z-index:9999;
      max-width:min(92vw, 720px);
      text-align:center;
    }
    .toast.show{display:block; animation:pop .2s ease;}
    @keyframes pop{from{transform:translateX(-50%) scale(.98); opacity:.6} to{transform:translateX(-50%) scale(1); opacity:1}}

    /* Night Mode ‚Äì Calm */
    body.night{
      --bg:#071a14;
      --card:#071f18;
      --ink:#e9fff3;
      --muted:#b9e7cf;
      --border:rgba(255,255,255,.08);
      background: radial-gradient(1200px 600px at 10% 10%, rgba(34,197,94,.12), transparent 60%),
                  radial-gradient(900px 500px at 90% 20%, rgba(34,197,94,.10), transparent 55%),
                  var(--bg);
    }
    body.night .pill, body.night .btn-ghost, body.night .card, body.night input[type="file"]{
      background: rgba(255,255,255,.04);
      border-color: rgba(255,255,255,.10);
      color: var(--ink);
    }
    body.night header{ background: linear-gradient(90deg, #16a34a, #22c55e); }
    body.night .xpbar{ background: rgba(255,255,255,.12); }

    footer{
      margin-top:18px;
      text-align:center;
      opacity:.9;
      font-size:.95rem;
      color:var(--muted);
      font-weight:700;
    }
    footer a{color:inherit;}
  </style>
</head>

<body>
  <header>
    <div class="left">
      <span aria-hidden="true">üß†</span>
      <a href="./index.html">MindCheck</a>
      <span style="opacity:.85;">‚Ä¢ Become a Counsellor</span>
    </div>

    <button id="nightToggle" class="btn btn-ghost" type="button" aria-label="Toggle night mode">
      üåô Night Mode
    </button>
  </header>

  <div class="wrap">
    <div class="topbar">
      <span class="pill">
        üéÆ Counsellor Quest
        <span class="xpbar" aria-label="Progress"><span id="xpFill"></span></span>
        <b id="xpText">0%</b>
      </span>
      <span class="pill">üîí You go ‚ÄúLive‚Äù only after verification</span>
    </div>

    <div class="grid">
      <!-- LEFT: Quest / Course + Exam -->
      <section class="card" aria-labelledby="title1">
        <h2 id="title1">Become a Verified Counsellor</h2>
        <p class="muted">
          Complete a <b>free certified course</b>, take the exam, and if you pass you‚Äôll download your certificate (PDF).
          Then upload it here for verification.
        </p>

        <div class="callout">
          üí° MindCheck counsellors provide supportive listening + guidance, not emergency response.
          If someone is in danger, they should call emergency services (Nigeria: <b>112</b>).
        </div>

        <div class="badges" role="list" aria-label="Quest steps">
          <span class="badge lock" id="bCourse" role="listitem">üìò Course: <span>Not started</span></span>
          <span class="badge lock" id="bExam" role="listitem">üß™ Exam: <span>Locked</span></span>
          <span class="badge lock" id="bCert" role="listitem">üèÖ Certificate: <span>Locked</span></span>
          <span class="badge lock" id="bUpload" role="listitem">üì§ Upload: <span>Locked</span></span>
        </div>

        <h3 style="margin-top:14px;">How it works</h3>
        <ol class="steps">
          <li>Start the free course.</li>
          <li>Mark the course as completed.</li>
          <li>Unlock the exam link and pass (target: <b>70%</b>).</li>
          <li>Download your certificate (PDF).</li>
          <li>Upload the certificate for verification.</li>
        </ol>

        <div class="row" style="margin-top:14px;">
          <!-- FREE COURSE (external) -->
          <a id="courseBtn" class="btn btn-primary"
             href="https://www.betherecertificate.org/"
             target="_blank" rel="noopener noreferrer">
            üìò Start free course
          </a>

          <button id="markCourseDone" class="btn btn-warn" type="button">
            ‚úÖ I finished the course
          </button>

          <!-- EXAM (external) - locked until course done -->
          <a id="examBtn" class="btn btn-ghost"
             href="https://www.betherecertificate.org/"
             target="_blank" rel="noopener noreferrer"
             aria-disabled="true"
             style="opacity:.65; pointer-events:none;">
            üß™ Start counsellor exam
          </a>

          <a class="btn btn-ghost" href="./index.html">‚Üê Back</a>
        </div>

        <p class="muted" style="margin-top:10px;">
          Tip: Use your real name exactly as you want it to appear on your certificate.
        </p>
      </section>

      <!-- RIGHT: Upload + status -->
      <section class="card" aria-labelledby="title2">
        <h3 id="title2">Upload Certificate for Verification</h3>
        <p class="muted">
          After passing, upload the certificate PDF here. We‚Äôll review and activate your counsellor profile.
        </p>

        <input id="certFile" type="file" accept="application/pdf,image/*" />
        <p><small>Accepted: PDF preferred. You can also upload an image if needed.</small></p>

        <div class="row" style="margin-top:8px;">
          <button id="saveUpload" class="btn btn-primary" type="button">üì§ Submit for Verification</button>
          <button id="clearUpload" class="btn btn-ghost" type="button">Clear</button>
          <button id="resetQuest" class="btn btn-danger" type="button" title="Reset your local progress on this device">Reset progress</button>
        </div>

        <p id="uploadStatus" class="muted" style="margin-top:10px;"></p>

        <hr style="border:none;border-top:1px solid rgba(148,163,184,.35);margin:16px 0;">

        <h3>Your last exam result</h3>
        <p class="muted" id="lastResult">No exam taken yet.</p>
        <div class="row">
          <a id="downloadCertBtn" class="btn btn-ghost" href="#" style="display:none;">‚¨áÔ∏è Download last certificate</a>
        </div>

        <div class="callout" style="margin-top:14px;">
          ‚úÖ Fast verification option: email your certificate to <b>speaaakout@gmail.com</b>
          (or WhatsApp your local SpeakOut coordinator).
        </div>
      </section>
    </div>

    <footer>
      üîí <a href="privacy.html">Privacy</a> ‚Ä¢ üìÑ <a href="terms.html">Terms</a> ‚Ä¢ ‚úâÔ∏è <a href="mailto:speaaakout@gmail.com">speaaakout@gmail.com</a>
    </footer>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    /***************
     * Night mode toggle (persists)
     ***************/
    const nightToggle = document.getElementById('nightToggle');
    const NIGHT_KEY = 'mc_night_mode';
    function applyNight(on){
      document.body.classList.toggle('night', !!on);
      nightToggle.textContent = on ? '‚òÄÔ∏è Day Mode' : 'üåô Night Mode';
      localStorage.setItem(NIGHT_KEY, on ? '1' : '0');
    }
    applyNight(localStorage.getItem(NIGHT_KEY) === '1');
    nightToggle.addEventListener('click', () => applyNight(!document.body.classList.contains('night')));

    /***************
     * Gamified quest state (local only)
     ***************/
    const toastEl = document.getElementById('toast');
    function toast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add('show');
      clearTimeout(toastEl._t);
      toastEl._t = setTimeout(() => toastEl.classList.remove('show'), 2600);
    }

    const KEY = {
      courseDone: 'mc_counsellor_course_done',
      certUploadedName: 'mc_cert_uploaded_name',
      examLast: 'mc_counsellor_exam_last'
    };

    const bCourse = document.getElementById('bCourse');
    const bExam   = document.getElementById('bExam');
    const bCert   = document.getElementById('bCert');
    const bUpload = document.getElementById('bUpload');
    const xpFill  = document.getElementById('xpFill');
    const xpText  = document.getElementById('xpText');

    const markCourseDoneBtn = document.getElementById('markCourseDone');
    const examBtn = document.getElementById('examBtn');

    // Step completion calculation (4 steps)
    function computeProgress(){
      const courseDone = localStorage.getItem(KEY.courseDone) === '1';
      const last = JSON.parse(localStorage.getItem(KEY.examLast) || 'null');
      const passed = !!(last && last.passed);
      const uploaded = !!localStorage.getItem(KEY.certUploadedName);

      const doneCount = (courseDone?1:0) + (passed?1:0) + (passed?1:0) + (uploaded?1:0);
      // Note: Cert step follows "passed"
      const pct = Math.round((doneCount/4)*100);

      // badges
      setBadge(bCourse, courseDone ? 'done' : 'lock', courseDone ? 'Completed ‚úÖ' : 'Not started');
      setBadge(bExam, courseDone ? 'warn' : 'lock', courseDone ? 'Unlocked üîì' : 'Locked');
      setBadge(bCert, passed ? 'done' : (courseDone ? 'warn' : 'lock'), passed ? 'Ready ‚úÖ' : (courseDone ? 'Pending exam' : 'Locked'));
      setBadge(bUpload, uploaded ? 'done' : (passed ? 'warn' : 'lock'), uploaded ? 'Submitted ‚úÖ' : (passed ? 'Upload needed' : 'Locked'));

      // exam link unlock
      if (courseDone){
        examBtn.style.opacity = '1';
        examBtn.style.pointerEvents = 'auto';
        examBtn.setAttribute('aria-disabled', 'false');
      } else {
        examBtn.style.opacity = '.65';
        examBtn.style.pointerEvents = 'none';
        examBtn.setAttribute('aria-disabled', 'true');
      }

      // xp bar
      xpFill.style.width = pct + '%';
      xpText.textContent = pct + '%';

      return {courseDone, passed, uploaded, pct};
    }

    function setBadge(el, type, text){
      el.classList.remove('lock','done','warn');
      el.classList.add(type);
      const span = el.querySelector('span');
      if (span) span.textContent = text;
    }

    markCourseDoneBtn.addEventListener('click', () => {
      localStorage.setItem(KEY.courseDone, '1');
      toast('Course marked as completed ‚úÖ Exam unlocked!');
      computeProgress();
    });

    /***************
     * Upload placeholder (static site): store "submitted" locally + give instructions
     ***************/
    const certFile = document.getElementById('certFile');
    const uploadStatus = document.getElementById('uploadStatus');

    document.getElementById('saveUpload').addEventListener('click', () => {
      const { passed } = computeProgress();
      if (!passed) {
        uploadStatus.textContent = '‚ö†Ô∏è Please pass the exam first before uploading (certificate is required).';
        toast('Pass the exam first üß™');
        return;
      }
      if (!certFile.files || !certFile.files[0]) {
        uploadStatus.textContent = '‚ö†Ô∏è Please select your certificate file first.';
        toast('Select a file first üìÑ');
        return;
      }

      localStorage.setItem(KEY.certUploadedName, certFile.files[0].name);
      uploadStatus.innerHTML =
        '‚úÖ Submitted (saved on this device).<br>' +
        'Next step: send the certificate to SpeakOut for verification via email: <b>speaaakout@gmail.com</b> ' +
        'or WhatsApp (if you prefer).';
      toast('Certificate submitted ‚úÖ');
      computeProgress();
    });

    document.getElementById('clearUpload').addEventListener('click', () => {
      certFile.value = '';
      uploadStatus.textContent = '';
      localStorage.removeItem(KEY.certUploadedName);
      toast('Cleared.');
      computeProgress();
    });

    document.getElementById('resetQuest').addEventListener('click', () => {
      localStorage.removeItem(KEY.courseDone);
      localStorage.removeItem(KEY.certUploadedName);
      // Don‚Äôt delete exam history unless you want:
      // localStorage.removeItem(KEY.examLast);
      toast('Progress reset on this device.');
      uploadStatus.textContent = '';
      certFile.value = '';
      computeProgress();
      renderLastExam();
    });

    /***************
     * Show last exam result (saved from exam page, if you implement it later)
     ***************/
    const lastResultEl = document.getElementById('lastResult');
    const downloadBtn = document.getElementById('downloadCertBtn');

    function renderLastExam(){
      const last = JSON.parse(localStorage.getItem(KEY.examLast) || 'null');

      if (last) {
        const dateStr = new Date(last.issuedAt || Date.now()).toLocaleString();
        lastResultEl.innerHTML =
          `Score: <b>${last.scorePct}%</b> ‚Ä¢ Result: <b>${last.passed ? 'PASSED ‚úÖ' : 'NOT PASSED ‚ùå'}</b> ‚Ä¢ Date: ${dateStr}`;

        if (last.passed && last.certDataUri) {
          downloadBtn.style.display = 'inline-flex';
          downloadBtn.href = last.certDataUri;
          downloadBtn.download = last.certFileName || 'MindCheck-Counsellor-Certificate.pdf';
          toast('Certificate ready üèÖ');
        } else {
          downloadBtn.style.display = 'none';
          downloadBtn.href = '#';
        }
      } else {
        lastResultEl.textContent = 'No exam taken yet.';
        downloadBtn.style.display = 'none';
        downloadBtn.href = '#';
      }
    }

    // Initial render
    renderLastExam();
    computeProgress();
  </script>
</body>
</html>
