<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SpeakOut MindCheck 💚</title>
  <link rel="icon" type="image/png" href="favicon.png" />
  <style>
    :root {
      --green:#22c55e; --greenDark:#16a34a; --ink:#062436;
      --bg:#f5fdf8; --card:#ffffff;
    }
    body {
      font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
      background:var(--bg); color:var(--ink);
      text-align:center; margin:0; padding:0;
    }
    header{background:var(--green);color:#fff;padding:1.2rem;font-size:1.6rem;font-weight:800;}
    p{margin:.75rem 0;}

    /* Buttons */
    .btn{border:none;padding:12px 16px;border-radius:14px;font-size:1rem;cursor:pointer;transition:.15s;}
    .btn-primary{background:var(--green);color:#fff;box-shadow:0 6px 20px rgba(34,197,94,.3);}
    .btn-primary:hover{background:var(--greenDark);}
    .btn-ghost{background:#fff;border:1px solid #e5e7eb;}

    /* Sections */
    section{display:none;padding:16px;animation:fadeIn .25s ease-in-out;}
    section.active{display:block;}

    /* Language */
    .twrap{display:flex;justify-content:center;flex-wrap:wrap;gap:12px;margin-top:10px;}
    .tbtn{background:var(--green);color:#fff;padding:10px 18px;border-radius:10px;font-weight:700;
      transition:.2s ease;display:inline-flex;align-items:center;gap:6px;cursor:pointer;
      box-shadow:0 4px 15px rgba(34,197,94,.25);}
    .tbtn:hover{background:var(--greenDark);transform:translateY(-1px) scale(1.03);}
    .tbtn.live{animation:pulse 2s infinite;}
    @keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(34,197,94,.4)}50%{box-shadow:0 0 0 10px rgba(34,197,94,0)}}
    .tbtn.soon{background:linear-gradient(145deg,#a7f3d0,#6ee7b7);color:#064e3b;cursor:default;position:relative;}
    .tbtn.soon::after{content:attr(data-tooltip);position:absolute;bottom:125%;left:50%;transform:translateX(-50%);
      background:#062436;color:#fff;padding:6px 10px;border-radius:6px;font-size:.8rem;white-space:nowrap;
      opacity:0;transition:opacity .3s;box-shadow:0 3px 8px rgba(0,0,0,.15);}
    .tbtn.soon:hover::after{opacity:1;}

    /* Grid + Cards */
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:14px;margin-top:16px;text-align:left;}
    .card{background:var(--card);border:1px solid #eef2f7;border-radius:14px;padding:16px;
      box-shadow:0 6px 18px rgba(2,23,34,.05);cursor:pointer;transition:transform .12s;}
    .card:hover{transform:translateY(-2px);}
    .card .big{font-size:28px;line-height:1;}
    .card h3{margin:.4rem 0 .25rem;font-size:1.05rem;}
    .card p{margin:.2rem 0 0;color:#52606d;font-size:.92rem;}

    /* Stats strip on Home */
    .stats{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin:10px auto;max-width:860px;}
    .pill{background:#fff;border:1px solid #e5e7eb;border-radius:999px;padding:8px 12px;font-weight:600;}

    /* Mood */
    .mood-row{display:flex;justify-content:center;gap:12px;margin:16px 0;flex-wrap:wrap;}
    .mood{font-size:28px;background:#fff;border:1px solid #ddd;border-radius:12px;padding:10px 12px;cursor:pointer;}
    .result{background:#f0f7ff;border:1px solid #cfe3ff;border-radius:10px;padding:12px;margin:12px auto;max-width:520px;}

    /* Badges list */
    .badge-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;margin:14px auto;max-width:900px;}
    .badge{border:1px solid #e8eef5;border-radius:12px;background:#fff;text-align:left;padding:12px;}
    .badge.locked{opacity:.55;}
    .badge .name{font-weight:700;margin:.2rem 0;}
    .badge .desc{font-size:.9rem;color:#52606d;margin:.1rem 0 .3rem;}
    .badge .status{font-size:.85rem;color:#0b5;}

    /* Iframe (Screenings) */
    iframe{width:100%;height:800px;border:0;border-radius:12px;background:#fff;}

    /* Anim */
    @keyframes fadeIn{from{opacity:0;transform:translateY(6px);}to{opacity:1;transform:translateY(0);}}
    footer{margin:28px 0 40px;font-size:.95rem;opacity:.9;} footer a{color:inherit;}
    .toolbar{display:flex;gap:10px;justify-content:center;margin-top:10px;flex-wrap:wrap;}
  </style>
</head>
<body>
  <header>🧠 SpeakOut MindCheck Nigeria</header>
  <p>Check your mental health privately, safely, and in your preferred language.</p>

  <button id="startBtn" class="btn btn-primary">Start Now</button>

  <!-- Language -->
  <section id="langSection">
    <p style="font-weight:700;">🌍 Choose your language:</p>
    <div class="twrap">
      <button class="tbtn live" data-lang="en">English</button>
      <span class="tbtn soon" data-tooltip="Launching soon in Hausa">🕓 Hausa — Coming Soon</span>
      <span class="tbtn soon" data-tooltip="Launching soon in Yoruba">🕓 Yoruba — Coming Soon</span>
      <span class="tbtn soon" data-tooltip="Launching soon in Igbo">🕓 Igbo — Coming Soon</span>
      <span class="tbtn soon" data-tooltip="Launching soon in French">🕓 French — Coming Soon</span>
    </div>
  </section>

  <!-- Home + Stats -->
  <section id="homeSection">
    <h2>Welcome to MindCheck 🌿</h2>
    <p id="statsText" style="color:#334155;font-weight:500;margin-bottom:4px;"></p>
    <div class="stats">
      <span class="pill">Points: <span id="pointsPill">0</span></span>
      <span class="pill">Streak: <span id="streakPill">0</span> day(s)</span>
    </div>
    <div class="grid">
      <div class="card" id="goMood"><div class="big">😊</div><h3>Check Your Mood</h3><p>Tap an emoji and earn points (once daily).</p></div>
      <div class="card" id="goScreenings"><div class="big">🧠</div><h3>Screenings</h3><p>WHO-5, PHQ-9, GAD-7, and PSS-10.</p></div>
      <a class="card" id="goTips" href="#"><div class="big">🌿</div><h3>Wellness Tips</h3><p>Simple habits for calm and focus.</p></a>
      <a class="card" id="goHelp" href="#"><div class="big">📞</div><h3>Get Help</h3><p>Find mental-health support nearby.</p></a>
      <div class="card" id="goBadges"><div class="big">🏅</div><h3>Badges & Awards</h3><p>See what you’ve unlocked.</p></div>
    </div>
  </section>

  <!-- Mood Check-in -->
  <section id="moodSection">
    <h2>How are you feeling today?</h2>
    <div class="mood-row">
      <button class="mood" data-val="4">😄</button>
      <button class="mood" data-val="3">😊</button>
      <button class="mood" data-val="2">😐</button>
      <button class="mood" data-val="1">😞</button>
      <button class="mood" data-val="0">😢</button>
    </div>
    <div id="moodResult" class="result" style="display:none;"></div>
    <div class="toolbar"><button id="moodBackHome" class="btn btn-ghost">Back to Home</button></div>
  </section>

  <!-- Screenings form -->
  <section id="formContainer">
    <iframe id="formFrame" src="" title="SpeakOut MindCheck form"></iframe>
    <div class="toolbar"><button id="formBackHome" class="btn btn-ghost">Back to Home</button></div>
  </section>

  <!-- Wellness Tips -->
  <section id="tipsSection">
    <h2>Wellness Tips 🌿</h2>
    <div class="toolbar">
      <button class="btn btn-ghost tip-filter" data-filter="all">All</button>
      <button class="btn btn-ghost tip-filter" data-filter="calm">Calm</button>
      <button class="btn btn-ghost tip-filter" data-filter="anxious">Anxious</button>
      <button class="btn btn-ghost tip-filter" data-filter="low">Low</button>
      <button class="btn btn-ghost tip-filter" data-filter="neutral">Neutral</button>
      <button class="btn btn-ghost tip-filter" data-filter="positive">Positive</button>
    </div>
    <div class="card" id="tipCard" style="max-width:680px;margin:14px auto;text-align:left;">
      <div class="big">🌱</div>
      <h3 id="tipText" style="margin:.5rem 0;"></h3>
      <p id="tipNote" style="color:#52606d;margin:0;"></p>
    </div>
    <div class="toolbar">
      <button id="nextTip" class="btn btn-primary">Show another tip</button>
      <button id="tipsBackHome" class="btn btn-ghost">Back to Home</button>
    </div>
  </section>

  <!-- Get Help -->
  <section id="helpSection">
    <h2>Get Help 📞</h2>
    <p style="color:#334155">If you're in immediate danger or feel unsafe, contact your local emergency number.</p>
    <div class="grid" style="max-width:820px;margin:0 auto;">
      <a class="card" href="tel:112"><div class="big">🚑</div><h3>Emergency Services</h3><p>Call 112 (or your country emergency number) for urgent help.</p></a>
      <a class="card" href="tel:+2348118103510"><div class="big">📞</div><h3>SpeakOut Helpline</h3><p>Call us for support and referral options.</p></a>
      <a class="card" href="https://wa.me/2348118103510" target="_blank" rel="noopener"><div class="big">💬</div><h3>WhatsApp</h3><p>Chat with a SpeakOut volunteer.</p></a>
      <a class="card" href="/MindCheck/resources.html"><div class="big">📍</div><h3>Clinics & Resources</h3><p>Find mental-health services near you.</p></a>
    </div>
    <div class="toolbar"><button id="helpBackHome" class="btn btn-ghost">Back to Home</button></div>
  </section>

  <!-- Badges -->
  <section id="badgesSection">
    <h2>Badges & Awards 🏅</h2>
    <p style="color:#334155">Earn points with daily mood check-ins and unlock streak or points milestones.</p>
    <div id="badgesGrid" class="badge-list"></div>
    <div class="toolbar"><button id="badgesBackHome" class="btn btn-ghost">Back to Home</button></div>
  </section>

  <footer style="margin-top:20px;">
    🔒 <a href="/MindCheck/privacy.html">Privacy</a> •
    📄 <a href="/MindCheck/terms.html">Terms</a> •
    ✉️ <a href="mailto:speaaakout@gmail.com">support@speakout.ng</a>
  </footer>

  <script>
    /* ---------- Elements & Sections ---------- */
    const startBtn=document.getElementById('startBtn');
    const langSection=document.getElementById('langSection');
    const homeSection=document.getElementById('homeSection');
    const moodSection=document.getElementById('moodSection');
    const formContainer=document.getElementById('formContainer');
    const tipsSection=document.getElementById('tipsSection');
    const helpSection=document.getElementById('helpSection');
    const badgesSection=document.getElementById('badgesSection');

    const formFrame=document.getElementById('formFrame');
    const statsText=document.getElementById('statsText');
    const pointsPill=document.getElementById('pointsPill');
    const streakPill=document.getElementById('streakPill');
    const moodResult=document.getElementById('moodResult');

    const tipText=document.getElementById('tipText');
    const tipNote=document.getElementById('tipNote');
    const nextTipBtn=document.getElementById('nextTip');
    const badgesGrid=document.getElementById('badgesGrid');

    function show(section){
      [langSection,homeSection,moodSection,formContainer,tipsSection,helpSection,badgesSection].forEach(s=>s.classList.remove('active'));
      section.classList.add('active');
      section.scrollIntoView({behavior:'smooth'});
      if(section===homeSection){ updateStats(); updateHeaderPills(); }
      if(section===badgesSection){ renderBadges(); }
    }

    /* ---------- Simple Navigation ---------- */
    startBtn.onclick=()=>{startBtn.style.display='none';show(langSection);};
    document.querySelectorAll('.tbtn.live').forEach(btn=>{
      btn.onclick=()=>{ localStorage.setItem('mc_lang', btn.dataset.lang || 'en'); show(homeSection); };
    });

    document.getElementById('goMood').onclick=()=>show(moodSection);
    document.getElementById('moodBackHome').onclick=()=>show(homeSection);

    document.getElementById('goScreenings').onclick=()=>{
      formFrame.src='https://tally.so/r/w2QbOV';
      show(formContainer);
    };
    document.getElementById('formBackHome').onclick=()=>show(homeSection);

    document.getElementById('goTips').onclick=(e)=>{e.preventDefault(); currentTipFilter = lastMoodTag(); show(tipsSection); renderTip();};
    document.getElementById('tipsBackHome').onclick=()=>show(homeSection);

    document.getElementById('goHelp').onclick=(e)=>{e.preventDefault(); show(helpSection);};
    document.getElementById('helpBackHome').onclick=()=>show(homeSection);

    document.getElementById('goBadges').onclick=()=>show(badgesSection);
    document.getElementById('badgesBackHome').onclick=()=>show(homeSection);

    /* ---------- Local Storage Keys ---------- */
    const KEY_POINTS='mc_points';
    const KEY_STREAK='mc_streak';
    const KEY_LAST='mc_lastCheckin'; // "YYYY-MM-DD"
    const KEY_HISTORY='mc_mood_history';
    const KEY_BADGES='mc_badges'; // ["first_checkin", ...]

    /* ---------- Helpers: Dates & Storage ---------- */
    function todayStr(){
      // Local calendar day in "YYYY-MM-DD"
      const d=new Date();
      const y=d.getFullYear();
      const m=String(d.getMonth()+1).padStart(2,'0');
      const day=String(d.getDate()).padStart(2,'0');
      return `${y}-${m}-${day}`;
    }
    function isoToDate(iso){ return new Date(iso); }

    function getJSON(key, fallback){ try{ return JSON.parse(localStorage.getItem(key) || JSON.stringify(fallback)); }catch(e){ return fallback; } }
    function setJSON(key, val){ localStorage.setItem(key, JSON.stringify(val)); }

    function getPoints(){ return parseInt(localStorage.getItem(KEY_POINTS)||'0',10); }
    function setPoints(v){ localStorage.setItem(KEY_POINTS, String(v)); }
    function addPoints(n){ setPoints(getPoints()+n); }

    function getStreak(){ return parseInt(localStorage.getItem(KEY_STREAK)||'0',10); }
    function setStreak(v){ localStorage.setItem(KEY_STREAK, String(v)); }

    function getLast(){ return localStorage.getItem(KEY_LAST) || ''; }
    function setLast(v){ localStorage.setItem(KEY_LAST, v); }

    function getBadges(){ return getJSON(KEY_BADGES, []); }
    function setBadges(arr){ setJSON(KEY_BADGES, arr); }
    function hasBadge(id){ return getBadges().includes(id); }
    function awardBadge(id){
      const b=getBadges();
      if(!b.includes(id)){ b.push(id); setBadges(b); return true; }
      return false;
    }

    /* ---------- Mood Check-in (Once Daily) ---------- */
    const moodButtons=document.querySelectorAll('.mood');
    moodButtons.forEach(btn=>{
      btn.onclick=()=>{
        const val=parseInt(btn.dataset.val,10);
        handleCheckin(val);
      };
    });

    function handleCheckin(moodValue){
      const today=todayStr();
      const last=getLast();

      // Enforce once per day
      if(last===today){
        moodResult.style.display='block';
        moodResult.innerHTML=`<p>✅ You already checked in today. Come back tomorrow!</p>`;
        return;
      }

      // Award points (+10) and set last check-in
      addPoints(10);
      setLast(today);

      // Streak logic (if yesterday checked in, +1 else reset to 1)
      const yesterdayStr = (()=>{ const d=new Date(); d.setDate(d.getDate()-1); return d.toISOString().slice(0,10); })();
      if(last===yesterdayStr){ setStreak(getStreak()+1); } else { setStreak(1); }

      // Save lightweight history for weekly stats
      const arr=getJSON(KEY_HISTORY, []);
      arr.push({ ts:new Date().toISOString(), mood_value:moodValue });
      setJSON(KEY_HISTORY, arr);

      // Friendly tip
      const emoji=['😢','😞','😐','😊','😄'][moodValue] || '😐';
      let tip="Take a deep breath for 60 seconds.";
      if(moodValue>=3) tip="Great mood! Share a smile today 🌻.";
      if(moodValue===2) tip="Stretch or walk a little to refresh.";
      if(moodValue<=1) tip="You’re not alone — breathe and reach out if you need help.";

      // Badge checks
      const newly=[];
      if(awardBadge('first_checkin')) newly.push('First Check-in');
      if(getStreak()>=3 && awardBadge('streak_3')) newly.push('3-Day Streak');
      if(getStreak()>=7 && awardBadge('streak_7')) newly.push('7-Day Streak');
      const pts=getPoints();
      if(pts>=100 && awardBadge('points_100')) newly.push('100 Points');
      if(pts>=300 && awardBadge('points_300')) newly.push('300 Points');

      // Show result
      moodResult.style.display='block';
      moodResult.innerHTML=`
        <p>🎉 Thanks for checking in ${emoji} — you earned <b>+10 points</b>.</p>
        <p>Streak: <b>${getStreak()}</b> day(s) • Points: <b>${getPoints()}</b></p>
        <p><b>Tip:</b> ${tip}</p>
        ${newly.length ? `<p>🏅 New badge${newly.length>1?'s':''}: <b>${newly.join(', ')}</b></p>` : ''}
      `;

      updateHeaderPills();
    }

    /* ---------- Home Stats ---------- */
    function updateHeaderPills(){
      pointsPill.textContent=getPoints();
      streakPill.textContent=getStreak();
    }

    function updateStats(){
      const arr=getJSON(KEY_HISTORY, []);
      const now=new Date();
      const weekAgo=new Date(now); weekAgo.setDate(now.getDate()-7);
      const weekCount=arr.filter(i=>{ const t=isoToDate(i.ts); return t>=weekAgo && t<=now; }).length;
      statsText.textContent = weekCount>0
        ? `📊 You’ve checked your mood ${weekCount} time${weekCount>1?'s':''} this week.`
        : `📊 You haven’t checked your mood this week yet — try it now!`;
    }

    /* ---------- Badges Catalog & Render ---------- */
    const BADGE_CATALOG = [
      { id:'first_checkin', name:'First Check-in', desc:'Your first ever mood check.' },
      { id:'streak_3', name:'3-Day Streak', desc:'Checked your mood 3 days in a row.' },
      { id:'streak_7', name:'7-Day Streak', desc:'Checked your mood 7 days in a row.' },
      { id:'points_100', name:'100 Points', desc:'Reached 100 total points.' },
      { id:'points_300', name:'300 Points', desc:'Reached 300 total points.' },
    ];

    function renderBadges(){
      const owned=new Set(getBadges());
      badgesGrid.innerHTML = BADGE_CATALOG.map(b=>{
        const unlocked=owned.has(b.id);
        return `
          <div class="badge ${unlocked?'':'locked'}">
            <div class="name">🏅 ${b.name}</div>
            <div class="desc">${b.desc}</div>
            <div class="status">${unlocked ? 'Unlocked ✅' : 'Locked 🔒'}</div>
          </div>
        `;
      }).join('');
    }

    /* ---------- Tips Engine ---------- */
    const TIPS = [
      { text: "Try 4-7-8 breathing for one minute.", tags: ["anxious","low","neutral"] },
      { text: "Take a 10-minute walk in fresh air.", tags: ["low","neutral","positive"] },
      { text: "Text a friend just to say hi.", tags: ["low","neutral","anxious"] },
      { text: "Write down 3 things you’re grateful for.", tags: ["neutral","low","positive"] },
      { text: "Drink a glass of water and stretch for 2 minutes.", tags: ["all","neutral","low"] },
      { text: "Mute non-urgent notifications for 30 minutes.", tags: ["anxious","neutral"] },
      { text: "Do a slow body scan from head to toe.", tags: ["calm","anxious","neutral"] },
    ];
    let currentTipFilter='all';
    function lastMoodTag(){
      const arr=getJSON(KEY_HISTORY, []);
      if(!arr.length) return 'all';
      const last=arr[arr.length-1].mood_value;
      if(last<=1) return 'low';
      if(last===2) return 'neutral';
      if(last>=3) return 'positive';
      return 'all';
    }
    function pickTip(filter='all'){
      const pool = filter==='all' ? TIPS : TIPS.filter(t=>t.tags.includes(filter));
      if(!pool.length) return { text:"Take a slow deep breath — you’ve got this.", tags:["all"] };
      return pool[Math.floor(Math.random()*pool.length)];
    }
    function renderTip(){
      const tip=pickTip(currentTipFilter);
      tipText.textContent=tip.text;
      tipNote.textContent=currentTipFilter==='all' ? 'General tip' : `Tip for: ${currentTipFilter}`;
    }
    document.querySelectorAll('.tip-filter').forEach(btn=>{
      btn.addEventListener('click', ()=>{ currentTipFilter=btn.dataset.filter||'all'; renderTip(); });
    });
    nextTipBtn.addEventListener('click', renderTip);

    /* ---------- Boot ---------- */
    // Start on language or resume home
    startBtn.style.display=''; // visible
  </script>
</body>
</html>
