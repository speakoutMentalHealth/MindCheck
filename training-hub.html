<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MindCheck Joint Volunteer Training â€” SpeakOut, Synia Aid Foundation & AfriHud</title>
  <link rel="icon" href="favicon.png"/>
  <link rel="stylesheet" href="mc-theme.css"/>
  <meta name="theme-color" content="#22c55e"/>

  <style>
    :root{
      --green:#22c55e; --greenDark:#16a34a;
      --ink:#062436; --bg:#f5fdf8; --card:#fff;
      --muted:#52606d; --border:#e8eef5; --shadow:0 10px 25px rgba(15,23,42,.06);
      --gold:#d4af37;
    }

    /* playful calm background */
    body{
      background:
        radial-gradient(1200px 600px at 12% 10%, rgba(34,197,94,.10), transparent 60%),
        radial-gradient(900px 500px at 90% 20%, rgba(212,175,55,.10), transparent 55%),
        var(--bg);
    }

    header{
      background: linear-gradient(90deg, var(--greenDark), var(--green));
      color:#fff;
      padding:1rem;
      font-weight:900;
      letter-spacing:.2px;
    }

    main{ max-width:980px; margin:0 auto; padding:14px; }

    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:16px;
      padding:16px;
      box-shadow: var(--shadow);
      margin:12px 0;
    }

    .muted{ color:var(--muted); }

    /* LESSONS: default hidden; JS will show current */
    .lesson{ display:none; background:#fff; border:1px solid var(--border); border-radius:16px; padding:16px; box-shadow:var(--shadow); margin:12px 0; text-align:left; }
    .lesson h3{ margin:.2rem 0 .35rem; font-size:1.15rem; }
    .lesson .hero{
      display:flex; gap:12px; align-items:center; flex-wrap:wrap;
      padding:12px; border-radius:14px; border:1px solid rgba(34,197,94,.18);
      background: linear-gradient(180deg, rgba(34,197,94,.08), rgba(255,255,255,.9));
      margin:.6rem 0 1rem;
    }
    .lesson img{
      width:92px; height:92px; object-fit:contain;
      border-radius:14px;
      background:#fff;
      border:1px solid rgba(34,197,94,.15);
      padding:10px;
    }
    .lesson ul{ margin:.4rem 0 .25rem; padding-left:18px; }
    .lesson li{ margin:.25rem 0; line-height:1.55; }

    .pillrow{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:10px; }
    .pill{
      border:1px solid var(--border);
      background:#fff;
      border-radius:999px;
      padding:7px 11px;
      font-weight:800;
      font-size:.85rem;
    }
    .pill.gold{ border-color: rgba(212,175,55,.35); background: rgba(212,175,55,.08); }

    .progress-wrap{
      display:flex; align-items:center; gap:10px; flex-wrap:wrap;
    }
    .progress{
      flex:1;
      height:12px;
      background:#eaf7ef;
      border:1px solid rgba(34,197,94,.22);
      border-radius:999px;
      overflow:hidden;
      min-width:180px;
    }
    .progress > div{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, var(--greenDark), var(--green));
      border-radius:999px;
      transition: width .25s ease;
    }

    .toolbar{
      display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:10px;
    }
    .btn{
      border:none;
      padding:12px 16px;
      border-radius:14px;
      font-size:1rem;
      cursor:pointer;
      transition:.15s;
      font-weight:900;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
    }
    .btn-primary{ background:var(--green); color:#fff; box-shadow:0 10px 20px rgba(34,197,94,.22); }
    .btn-primary:hover{ background:var(--greenDark); transform:translateY(-1px); }
    .btn-ghost{ background:#fff; border:1px solid #e5e7eb; color:var(--ink); }
    .btn-ghost:hover{ transform:translateY(-1px); }

    .btn[disabled]{ opacity:.5; cursor:not-allowed; transform:none !important; }

    /* fun mini-quiz inside each lesson */
    .mini{
      margin-top:12px;
      border:1px dashed rgba(34,197,94,.35);
      border-radius:14px;
      padding:12px;
      background: rgba(34,197,94,.05);
    }
    .mini b{ color:#0f5132; }
    .mini .choices{ margin-top:8px; display:grid; gap:8px; }
    .choice{
      border:1px solid rgba(148,163,184,.35);
      background:#fff;
      border-radius:12px;
      padding:10px;
      cursor:pointer;
      transition:.12s;
      font-weight:700;
    }
    .choice:hover{ transform:translateY(-1px); border-color: rgba(34,197,94,.35); }
    .choice.correct{ border-color: rgba(34,197,94,.55); background: rgba(34,197,94,.08); }
    .choice.wrong{ border-color: rgba(239,68,68,.55); background: rgba(239,68,68,.06); }

    /* toast */
    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform:translateX(-50%);
      background:#062436;
      color:#fff;
      padding:10px 14px;
      border-radius:999px;
      box-shadow:0 12px 24px rgba(0,0,0,.18);
      font-weight:900;
      opacity:0;
      pointer-events:none;
      transition:opacity .18s ease, transform .18s ease;
      z-index:9999;
    }
    .toast.show{ opacity:1; transform:translateX(-50%) translateY(-2px); }

    /* quiz card styles (your main quiz) */
    .quiz-card{ background:#fff; border:1px solid var(--border); border-radius:16px; padding:16px; box-shadow:var(--shadow); }
    .q{ margin:12px 0; text-align:left; }
    .q legend{ font-weight:900; margin-bottom:6px; }
    .q label{ display:block; padding:8px 10px; border:1px solid var(--border); border-radius:12px; margin:8px 0; cursor:pointer; transition:background .15s,border-color .15s,transform .1s; }
    .q input{ margin-right:8px; }
    .q label:hover{ background:#f9fafb; border-color:#cbd5f5; transform:translateY(-1px); }
    .result{ display:none; margin-top:12px; font-weight:900; }
    .good{ color:#166534; }
    .bad{ color:#7f1d1d; }
    .timer{ font-weight:900; }
    .warn{ color:#854d0e; }

    footer{ margin:20px 0 10px; text-align:center; }
  </style>

  <!-- Plausible -->
  <script defer data-domain="speakoutmentalhealth.github.io" src="https://plausible.io/js/script.js"></script>
</head>

<body>
  <header>ğŸ§  MindCheck Nigeria â€” SpeakOut â€¢ Synia Aid Foundation â€¢ AfriHud</header>

  <main>
    <div class="card">
      <h2 style="margin:.2rem 0;">Start Your Certified Training</h2>
      <p class="muted" style="max-width:820px;margin:.25rem 0;">
        Complete the lessons like levels. After each lesson, answer the mini-challenge to earn XP.
        When all 5 are completed, the main quiz unlocks.
      </p>

      <div class="pillrow">
        <span class="pill">ğŸ¯ Pass main quiz: <b>80%</b></span>
        <span class="pill">â±ï¸ Main quiz: <b>10 minutes</b></span>
        <span class="pill gold">ğŸ… Reward: +50 points + â€œVolunteer Trainedâ€ badge</span>
      </div>

      <div class="progress-wrap" style="margin-top:12px;">
        <div class="pill" id="lessonStatus">Lesson 1 of 5</div>
        <div class="progress" aria-label="Lesson progress">
          <div id="progressBar"></div>
        </div>
        <div class="pill" id="xpPill">âœ¨ XP: 0</div>
      </div>
    </div>

    <!-- About partnership -->
    <div class="card" style="text-align:left;">
      <b>About this partnership</b>
      <p class="muted" style="margin:.35rem 0;">
        Joint initiative of SpeakOut Mental Health Outreach, Synia Aid Foundation, and AfriHud.
        Your certificate confirms completion of the joint volunteer training.
      </p>
    </div>

    <!-- LESSONS: MUST contain real content (not placeholders) -->

    <!-- Lesson 1 -->
    <section class="lesson" data-lesson="1">
      <h3>Level 1 â€” Safe Listening Basics (L-I-S-T-E-N)</h3>
      <div class="hero">
        <img src="icons/listen.png" alt="Safe Listening" onerror="this.style.display='none'">
        <div>
          <div class="pill gold">ğŸ† Goal: learn L-I-S-T-E-N</div>
          <p class="muted" style="margin:.35rem 0 0;">
            Listen, Inquire, Summarize, Thank, Empathize, Next steps.
          </p>
        </div>
      </div>

      <!-- âœ… PASTE your full Lesson 1 content here (you can keep your exact paragraphs + lists) -->
      <ul>
        <li><b>L â€” Listen:</b> Give full attention, remove distractions.</li>
        <li><b>I â€” Inquire:</b> Ask open questions.</li>
        <li><b>S â€” Summarize:</b> Reflect what you heard.</li>
        <li><b>T â€” Thank:</b> Appreciate their trust.</li>
        <li><b>E â€” Empathize:</b> Validate feelings.</li>
        <li><b>N â€” Next steps:</b> Agree one small step.</li>
      </ul>

      <div class="mini" data-mini="1">
        <b>Mini-challenge ğŸ®</b>
        <div class="muted">Which response best shows safe listening?</div>
        <div class="choices">
          <div class="choice" data-correct="0">Interrupt to give solutions</div>
          <div class="choice" data-correct="1">Listen, reflect, ask open questions âœ…</div>
          <div class="choice" data-correct="0">Tell them others have it worse</div>
        </div>
      </div>

      <div class="toolbar">
        <button class="btn btn-ghost" id="prevLesson" type="button">â¬…ï¸ Previous</button>
        <button class="btn btn-primary" id="completeLesson" type="button">Mark lesson completed âœ…</button>
        <button class="btn btn-primary" id="nextLesson" type="button">Next â¡ï¸</button>
      </div>
      <p class="muted" id="lessonHint" style="text-align:center;margin-top:10px;">
        Tip: Complete the mini-challenge, then mark this lesson completed to unlock the next level.
      </p>
    </section>

    <!-- Lesson 2 -->
    <section class="lesson" data-lesson="2">
      <h3>Level 2 â€” Red Flags & Immediate Danger</h3>
      <div class="hero">
        <img src="icons/red-flags.png" alt="Red Flags" onerror="this.style.display='none'">
        <div>
          <div class="pill gold">ğŸš¨ Goal: spot danger fast</div>
          <p class="muted" style="margin:.35rem 0 0;">Know what needs immediate escalation.</p>
        </div>
      </div>

      <!-- âœ… PASTE your full Lesson 2 content here -->
      <ul>
        <li>Active self-harm plan or intent.</li>
        <li>Current violence or threat.</li>
        <li>Child/vulnerable person at risk.</li>
        <li>Severe confusion, hallucinations commanding harm.</li>
      </ul>

      <div class="mini" data-mini="2">
        <b>Mini-challenge ğŸ®</b>
        <div class="muted">Which is an immediate red flag?</div>
        <div class="choices">
          <div class="choice" data-correct="0">Occasional sadness</div>
          <div class="choice" data-correct="1">Active self-harm plan âœ…</div>
          <div class="choice" data-correct="0">Feeling tired after work</div>
        </div>
      </div>

      <div class="toolbar">
        <button class="btn btn-ghost" id="prevLesson2" type="button">â¬…ï¸ Previous</button>
        <button class="btn btn-primary" id="completeLesson2" type="button">Mark lesson completed âœ…</button>
        <button class="btn btn-primary" id="nextLesson2" type="button">Next â¡ï¸</button>
      </div>
    </section>

    <!-- Lesson 3 -->
    <section class="lesson" data-lesson="3">
      <h3>Level 3 â€” Boundaries & Ethical Referral</h3>
      <div class="hero">
        <img src="icons/referral.png" alt="Referral" onerror="this.style.display='none'">
        <div>
          <div class="pill gold">ğŸ§­ Goal: refer safely</div>
          <p class="muted" style="margin:.35rem 0 0;">Offer choices, get consent, keep scope.</p>
        </div>
      </div>

      <!-- âœ… PASTE your full Lesson 3 content here -->
      <ul>
        <li>Your scope: listening + referral, not diagnosis.</li>
        <li>Ask consent before referrals.</li>
        <li>Offer 2â€“3 options.</li>
      </ul>

      <div class="mini" data-mini="3">
        <b>Mini-challenge ğŸ®</b>
        <div class="muted">Before making a referral you should:</div>
        <div class="choices">
          <div class="choice" data-correct="1">Get consent and offer choices âœ…</div>
          <div class="choice" data-correct="0">Choose one clinic for them</div>
          <div class="choice" data-correct="0">Ask for full medical history</div>
        </div>
      </div>

      <div class="toolbar">
        <button class="btn btn-ghost" id="prevLesson3" type="button">â¬…ï¸ Previous</button>
        <button class="btn btn-primary" id="completeLesson3" type="button">Mark lesson completed âœ…</button>
        <button class="btn btn-primary" id="nextLesson3" type="button">Next â¡ï¸</button>
      </div>
    </section>

    <!-- Lesson 4 -->
    <section class="lesson" data-lesson="4">
      <h3>Level 4 â€” Privacy-First Logging</h3>
      <div class="hero">
        <img src="icons/privacy.png" alt="Privacy" onerror="this.style.display='none'">
        <div>
          <div class="pill gold">ğŸ”’ Goal: minimum necessary</div>
          <p class="muted" style="margin:.35rem 0 0;">Short, respectful, no identifying info.</p>
        </div>
      </div>

      <!-- âœ… PASTE your full Lesson 4 content here -->
      <ul>
        <li>Log date/time + concern + action taken.</li>
        <li>Do not log names, addresses, screenshots.</li>
      </ul>

      <div class="mini" data-mini="4">
        <b>Mini-challenge ğŸ®</b>
        <div class="muted">Privacy-first logging means:</div>
        <div class="choices">
          <div class="choice" data-correct="1">Use minimal facts only âœ…</div>
          <div class="choice" data-correct="0">Write their full name and story</div>
          <div class="choice" data-correct="0">Screenshot the chat</div>
        </div>
      </div>

      <div class="toolbar">
        <button class="btn btn-ghost" id="prevLesson4" type="button">â¬…ï¸ Previous</button>
        <button class="btn btn-primary" id="completeLesson4" type="button">Mark lesson completed âœ…</button>
        <button class="btn btn-primary" id="nextLesson4" type="button">Next â¡ï¸</button>
      </div>
    </section>

    <!-- Lesson 5 -->
    <section class="lesson" data-lesson="5">
      <h3>Level 5 â€” Cultural Sensitivity & Volunteer Self-Care</h3>
      <div class="hero">
        <img src="icons/culture.png" alt="Culture" onerror="this.style.display='none'">
        <div>
          <div class="pill gold">ğŸ’š Goal: respect + sustainability</div>
          <p class="muted" style="margin:.35rem 0 0;">Sensitive support + boundaries to avoid burnout.</p>
        </div>
      </div>

      <!-- âœ… PASTE your full Lesson 5 content here -->
      <ul>
        <li>Ask language preference, respect beliefs.</li>
        <li>Debrief, hydrate, rest, set limits.</li>
      </ul>

      <div class="mini" data-mini="5">
        <b>Mini-challenge ğŸ®</b>
        <div class="muted">Cultural sensitivity includes:</div>
        <div class="choices">
          <div class="choice" data-correct="1">Respecting beliefs & language âœ…</div>
          <div class="choice" data-correct="0">Assuming everyone thinks alike</div>
          <div class="choice" data-correct="0">Correcting their culture</div>
        </div>
      </div>

      <div class="toolbar">
        <button class="btn btn-ghost" id="prevLesson5" type="button">â¬…ï¸ Previous</button>
        <button class="btn btn-primary" id="completeLesson5" type="button">Finish lessons âœ…</button>
        <a class="btn btn-primary" href="#quiz">Unlock main quiz â¡ï¸</a>
      </div>
    </section>

    <!-- MAIN QUIZ (keep your big quiz section below as you already have it) -->
    <section class="quiz-card" id="quiz" style="margin-top:14px;">
      <h3>Main Volunteer Quiz</h3>
      <p class="muted" style="text-align:left">
        <span class="pill">Pass mark: 80%</span>
        <span class="pill">Time: <span id="timeLeft" class="timer">10:00</span></span>
        <span class="pill" id="attemptInfo">Attempts this month: 0 / 2</span>
      </p>

      <!-- You can paste your existing quiz UI + logic here unchanged,
           OR keep your current code further down the file. -->
      <div class="toolbar" id="preQuizBar">
        <button id="startQuiz" class="btn btn-primary" type="button" disabled>Start Quiz</button>
        <a class="btn btn-ghost" href="volunteers.html">â† Back to Volunteer Zone</a>
      </div>

      <div class="card muted" id="quizLockMsg" style="text-align:left;">
        ğŸ”’ Finish all 5 lessons (mark each completed) to unlock the main quiz.
      </div>
    </section>

    <footer>
      ğŸ”’ <a href="privacy.html">Privacy</a> â€¢
      ğŸ“„ <a href="terms.html">Terms</a> â€¢
      ğŸ¥ <a href="resources.html">Clinics & Resources</a> â€¢
      âœ‰ï¸ <a href="mailto:speaaakout@gmail.com">speaaakout@gmail.com</a>
    </footer>
  </main>

  <div class="toast" id="toast">âœ… Saved</div>

  <script>
    // ====== KEY FIX: run only after DOM is ready ======
    document.addEventListener('DOMContentLoaded', () => {

      const KEY_LESSON_PROGRESS = 'mc_training_lessons_done';
      const KEY_XP = 'mc_training_xp';
      const totalLessons = 5;

      const lessons = Array.from(document.querySelectorAll('.lesson'));
      const progressBar = document.getElementById('progressBar');
      const lessonStatus = document.getElementById('lessonStatus');
      const xpPill = document.getElementById('xpPill');
      const toast = document.getElementById('toast');

      // If you still have your existing quiz system, keep your startQuiz gating tied to this:
      const startQuizBtn = document.getElementById('startQuiz');
      const quizLockMsg = document.getElementById('quizLockMsg');

      let currentLessonIndex = 0;

      function showToast(msg){
        if(!toast) return;
        toast.textContent = msg;
        toast.classList.add('show');
        setTimeout(()=>toast.classList.remove('show'), 1300);
      }

      function getXP(){ return parseInt(localStorage.getItem(KEY_XP) || '0', 10); }
      function addXP(n){
        localStorage.setItem(KEY_XP, String(getXP() + n));
        if(xpPill) xpPill.textContent = `âœ¨ XP: ${getXP()}`;
      }

      function getCompleted(){ return parseInt(localStorage.getItem(KEY_LESSON_PROGRESS) || '0', 10); }
      function setCompleted(n){ localStorage.setItem(KEY_LESSON_PROGRESS, String(n)); }

      function updateProgressUI(){
        const done = Math.min(totalLessons, Math.max(0, getCompleted()));
        const pct = Math.round((done / totalLessons) * 100);

        if(progressBar) progressBar.style.width = pct + '%';
        if(lessonStatus) lessonStatus.textContent = `Lesson ${currentLessonIndex + 1} of ${totalLessons}`;

        if(xpPill) xpPill.textContent = `âœ¨ XP: ${getXP()}`;

        const unlocked = done >= totalLessons;
        if(startQuizBtn) startQuizBtn.disabled = !unlocked;
        if(quizLockMsg) quizLockMsg.style.display = unlocked ? 'none' : 'block';
      }

      function showLesson(index){
        lessons.forEach((sec, i) => sec.style.display = (i === index ? 'block' : 'none'));
        currentLessonIndex = index;
        updateProgressUI();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }

      // mini-challenges (tap to answer)
      function initMiniChallenges(){
        document.querySelectorAll('.mini').forEach(mini => {
          const choices = Array.from(mini.querySelectorAll('.choice'));
          let answered = false;

          choices.forEach(ch => {
            ch.addEventListener('click', () => {
              if(answered) return;
              answered = true;

              const correct = ch.getAttribute('data-correct') === '1';
              ch.classList.add(correct ? 'correct' : 'wrong');

              // show the correct one if user chose wrong
              if(!correct){
                const correctEl = choices.find(x => x.getAttribute('data-correct') === '1');
                if(correctEl) correctEl.classList.add('correct');
              }

              addXP(correct ? 10 : 5);
              showToast(correct ? 'ğŸ‰ Correct! +10 XP' : 'âœ… Nice try! +5 XP');
            });
          });
        });
      }

      // navigation buttons per lesson (support both id patterns)
      function wireNav(){
        function prev(){
          if(currentLessonIndex > 0) showLesson(currentLessonIndex - 1);
        }
        function next(){
          if(currentLessonIndex < totalLessons - 1) showLesson(currentLessonIndex + 1);
        }

        // previous buttons
        ['prevLesson','prevLesson2','prevLesson3','prevLesson4','prevLesson5'].forEach(id=>{
          const el = document.getElementById(id);
          if(el) el.addEventListener('click', prev);
        });

        // next buttons
        ['nextLesson','nextLesson2','nextLesson3','nextLesson4'].forEach(id=>{
          const el = document.getElementById(id);
          if(el) el.addEventListener('click', next);
        });

        // completion buttons (must mark completed to unlock)
        function completeCurrent(){
          const done = getCompleted();
          // You can only increase progress forward, not backward
          const shouldBeDone = Math.max(done, currentLessonIndex + 1);
          setCompleted(shouldBeDone);

          showToast('ğŸ Lesson saved!');
          updateProgressUI();

          // Auto move forward except last lesson
          if(currentLessonIndex < totalLessons - 1) next();
          else showToast('ğŸ… All lessons completed â€” quiz unlocked!');
        }

        ['completeLesson','completeLesson2','completeLesson3','completeLesson4','completeLesson5'].forEach(id=>{
          const el = document.getElementById(id);
          if(el) el.addEventListener('click', completeCurrent);
        });
      }

      // ====== initialize ======
      initMiniChallenges();
      wireNav();

      // IMPORTANT: ensure at least one lesson shows even if storage has weird values
      const done = Math.min(totalLessons, Math.max(0, getCompleted()));
      // start at last completed lesson (or lesson 1)
      const startIndex = done > 0 ? Math.min(done - 1, totalLessons - 1) : 0;
      showLesson(startIndex);

      // page analytics event (optional)
      try { window.plausible && window.plausible('TrainingHubViewed'); } catch(e) {}
    });
  </script>
</body>
</html>
